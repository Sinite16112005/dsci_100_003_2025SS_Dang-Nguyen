<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>b7ba35ede5fa42fdaed72f4fe1c20cc9</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="ab0f3831-0222-4d9f-9a97-57a7003e3093" class="cell markdown">
<h1>DSCI 100 003 - Project Final Report - DANG NGUYEN - 31923584</h1>
</div>
<div id="54d8bc8e-a806-4f1c-a1e7-e6a29c40f4c4" class="cell markdown">
<h1 id="introduction">Introduction</h1>
</div>
<div id="facdeed3-0330-4219-8a67-550a6c5776c4" class="cell markdown">
<h2 id="background">Background</h2>
<p>A computer science group at UBC has set up a
<strong>Minecraft</strong> server and is recording gameplay sessions to
better understand how people interact with video games. In doing so,
they produced two datasets: one holding player information and the other
including previous play sessions. The project's purpose is to use the
data produced by the Minecraft server to answer one of the project's
lead, <strong>Frank Wood</strong>'s inquiries.</p>
<p>The question I have chosen to focus on is question 1:</p>
<blockquote>
<p><strong>"What kinds of players are most likely to contribute a large
amount of data?" Specifically, I am interested in learning how a
player's age might be related to how much data they contribute (i.e.
total played hours)."</strong></p>
</blockquote>
<p>I picked this question because I feel it is the most important to the
study team. Understanding which participants offer the most data is
crucial for the study team since they require more than just demographic
data to answer the group's other two queries. Essentially, by assessing
and selecting the most valuable player group(s) in terms of data
contribution, I may assist the study team in identifying individuals who
will be useful in answering the remaining questions.</p>
</div>
<div id="5f46e1b4-2c7a-4581-8700-638731f42def" class="cell markdown">
<h2 id="data-description">Data Description</h2>
<p>The given data consists of two csv files: 'Players' (7 variables, 196
observations) and 'Sessions' (5 variables, 1535 observations). Both are
summarized here.</p>
</div>
<div id="8c175aa9-0ccc-4e44-9642-055da80de733" class="cell markdown">
<h3 id="players">Players</h3>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 12%" />
<col style="width: 28%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Type of Data*</th>
<th style="text-align: left;">Interpretation</th>
<th style="text-align: left;">Options / Other Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">experience</td>
<td style="text-align: left;">categorial - ordinal</td>
<td style="text-align: left;">experience level of player, selected by
player</td>
<td style="text-align: left;"><em>Beginner, Amateur, Regular, Pro,
Veteran</em></td>
</tr>
<tr class="even">
<td style="text-align: left;">hashedEmail</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">email address of player in hashed
form</td>
<td style="text-align: left;">e.g. f6daba428a5e19a3d47574858c135...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">name</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">pseudonym chosen by player</td>
<td style="text-align: left;">Many options were provided to players.
Given this, it makes sense to treat this as character, not factor.</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">categorial</td>
<td style="text-align: left;">gender of player, selected by the
player</td>
<td style="text-align: left;"><em>Male, Female, Non-binary, Agender,
Two-Spirited, Other, Prefer not to say</em></td>
</tr>
<tr class="odd">
<td style="text-align: left;">played_hours</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">number of hours player has played on
server</td>
<td style="text-align: left;">e.g. 22.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">age of player, selected by the player</td>
<td style="text-align: left;">e.g. 30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">subscribe</td>
<td style="text-align: left;">logical</td>
<td style="text-align: left;">whether player subscribed to PlaiCraft
updates</td>
<td style="text-align: left;"><em>TRUE, FALSE</em></td>
</tr>
</tbody>
</table>
<ul>
<li>Represents most appropriate type, not the type initially assigned by
R.</li>
</ul>
<h3 id="sessions">Sessions</h3>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 31%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Type of Data*</th>
<th style="text-align: left;">Interpretation</th>
<th style="text-align: left;">Other Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hashed_Email</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">email address of player in hashed
form</td>
<td style="text-align: left;">e.g. 50499be23603422e6a0ee97...</td>
</tr>
<tr class="even">
<td style="text-align: left;">start_time</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">date, time Plaicraft session began</td>
<td style="text-align: left;">e.g. 30/06/2024 18:12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">end_time</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">date, time Plaicraft session finished</td>
<td style="text-align: left;">e.g. 30/06/2024 18:24</td>
</tr>
<tr class="even">
<td style="text-align: left;">original_start_time</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">UNIX timestamp of session start</td>
<td style="text-align: left;">e.g. 1.71977E+12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">original_end_time</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">UNIX timestamp of session end</td>
<td style="text-align: left;">e.g. 1.71977E+12</td>
</tr>
</tbody>
</table>
</div>
<div id="2966570d-51b9-4d7c-9224-30ca1a2a91f3" class="cell markdown">
<h1 id="method--results">Method &amp; Results</h1>
</div>
<div id="81245520-9253-4bf4-8d99-5b5dfe5b6d5c" class="cell markdown">
<h2 id="loading-data">Loading Data</h2>
<p>First, I load the necessary libraries, then read the datasets.</p>
</div>
<div id="ab964071-5fdd-46ab-824e-18cb34266eaf" class="cell code"
data-execution_count="48">
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(repr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>players <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;players.csv&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sessions <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;sessions.csv&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Rows: 196 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (4): experience, hashedEmail, name, gender
dbl (2): played_hours, Age
lgl (1): subscribe

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 1535 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (3): hashedEmail, start_time, end_time
dbl (2): original_start_time, original_end_time

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
</div>
</div>
<div id="04be468f-f56b-432b-ad7d-97d7d82c8118" class="cell markdown">
<h2 id="wrangling--cleaning-data">Wrangling &amp; Cleaning Data</h2>
<p>Then, using the <code>as_factor</code> function, I redefine the
<code>experience</code> and <code>gender</code> columns as
<strong>factors</strong>, ensuring that these variables are considered
as categorical.</p>
</div>
<div id="693085e0-d02d-4739-9756-d907c3692304" class="cell code"
data-execution_count="49">
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>players<span class="sc">$</span>experience <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(players<span class="sc">$</span>experience)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>players<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(players<span class="sc">$</span>gender)</span></code></pre></div>
</div>
<div id="f53ed860-d2d7-4bf3-a945-ddcb51f72a84" class="cell markdown">
<p>I also use <code>group_by</code> to build a new
<code>sessions_sum</code> data frame, which I then summarize. This
displays me the number of sessions per hashed email, or per
individual.</p>
</div>
<div id="9a0ace29-f212-44b4-b821-0b3716937350" class="cell code"
data-execution_count="50">
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> <span class="fu">group_by</span>(sessions, hashedEmail)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sessions_sum <span class="ot">&lt;-</span> <span class="fu">summarise</span>(grouped_data, <span class="at">number_of_sessions =</span> <span class="fu">n</span>())</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sessions_sum)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A tibble: 6 × 2</caption>
<thead>
	<tr><th scope=col>hashedEmail</th><th scope=col>number_of_sessions</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>0088b5e134c3f0498a18c7ea6b8d77b4b0ff1636fc93355ccc95b45423367832</td><td> 2</td></tr>
	<tr><td>060aca80f8cfbf1c91553a72f4d5ec8034764b05ab59fe8e1cf0eee9a7b67967</td><td> 1</td></tr>
	<tr><td>0ce7bfa910d47fc91f21a7b3acd8f33bde6db57912ce0290fa0437ce0b97f387</td><td> 1</td></tr>
	<tr><td>0d4d71be33e2bc7266ee4983002bd930f69d304288a8663529c875f40f1750f3</td><td>13</td></tr>
	<tr><td>0d70dd9cac34d646c810b1846fe6a85b9e288a76f5dcab9c1ff1a0e7ca200b3a</td><td> 2</td></tr>
	<tr><td>11006065e9412650e99eea4a4aaaf0399bc338006f85e80cc82d18b49f0e2aa4</td><td> 1</td></tr>
</tbody>
</table>

</div>
</div>
<div id="cd8f726b-5d8c-4bc0-a3e8-9b56604989d3" class="cell markdown">
<p><strong>Table 1. Hashed Email &amp; Number of Sessions</strong> <br>
(Only the head is displayed for the sake of readability.)</p>
</div>
<div id="0ab32ac6-71c6-4a60-b9bc-7f7f277e4aa1" class="cell markdown">
<p>Next, I use <code>merge</code> to tie this data frame to the
<code>players</code> data frame. This pulls together all the necessary
factors. This allows me to use a single data frame for all future
analytic stages.</p>
</div>
<div id="4cea7af3-b07f-42e4-998a-668f49f0eb75" class="cell code"
data-execution_count="51">
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">merge</span>(players, sessions_sum, <span class="at">by =</span> <span class="st">&quot;hashedEmail&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>hashedEmail</th><th scope=col>experience</th><th scope=col>subscribe</th><th scope=col>played_hours</th><th scope=col>name</th><th scope=col>gender</th><th scope=col>Age</th><th scope=col>number_of_sessions</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>0088b5e134c3f0498a18c7ea6b8d77b4b0ff1636fc93355ccc95b45423367832</td><td>Regular </td><td> TRUE</td><td>1.5</td><td>Isaac  </td><td>Male</td><td>20</td><td> 2</td></tr>
	<tr><th scope=row>2</th><td>055d1a2002f6308a95b03b8d17af28f43e9f91ca8b1e1fc439bf4d08b22e7c0f</td><td>Veteran </td><td> TRUE</td><td>0.0</td><td>Frankie</td><td>Male</td><td>17</td><td>NA</td></tr>
	<tr><th scope=row>3</th><td>060aca80f8cfbf1c91553a72f4d5ec8034764b05ab59fe8e1cf0eee9a7b67967</td><td>Pro     </td><td>FALSE</td><td>0.4</td><td>Lyra   </td><td>Male</td><td>21</td><td> 1</td></tr>
	<tr><th scope=row>4</th><td>0ce7bfa910d47fc91f21a7b3acd8f33bde6db57912ce0290fa0437ce0b97f387</td><td>Beginner</td><td> TRUE</td><td>0.1</td><td>Osiris </td><td>Male</td><td>17</td><td> 1</td></tr>
	<tr><th scope=row>5</th><td>0d4d71be33e2bc7266ee4983002bd930f69d304288a8663529c875f40f1750f3</td><td>Regular </td><td> TRUE</td><td>5.6</td><td>Winslow</td><td>Male</td><td>17</td><td>13</td></tr>
	<tr><th scope=row>6</th><td>0d70dd9cac34d646c810b1846fe6a85b9e288a76f5dcab9c1ff1a0e7ca200b3a</td><td>Pro     </td><td> TRUE</td><td>1.0</td><td>Knox   </td><td>Male</td><td>17</td><td> 2</td></tr>
</tbody>
</table>

</div>
</div>
<div id="510a350b-56c3-4ef9-afa9-fe75a0b8e58e" class="cell markdown">
<p><strong>Table 2. Dataframe of all player variables</strong> <br>
(Only the head is displayed for the sake of readability.)</p>
</div>
<div id="62772f28-0c4c-4fad-9756-598fadf2b19e" class="cell markdown">
<h2 id="data-analysis-1---linear-regression">Data Analysis 1 - Linear
Regression</h2>
<p>I begin my data analysis by setting the seed. The data was then
divided into two sets: training and testing, using a 70:30 ratio.</p>
</div>
<div id="e5b26294-5383-43f7-9e2f-4cc7bf129f61" class="cell code"
data-execution_count="52">
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data, <span class="at">prop =</span> <span class="fl">0.7</span>, <span class="at">strata =</span> Age)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data_training <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data_testing <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span></code></pre></div>
</div>
<div id="700a9b1f-5210-4ab0-84f1-f27e5321f3f5" class="cell markdown">
<h3
id="summary-of-dataset-relevant-for-exploratory-data-analysis">Summary
of Dataset Relevant For Exploratory Data Analysis</h3>
<p>Here, I provide a brief overview of the data relevant to my
exploratory data analysis (i.e., 'Age'), calculating the mean, maximum
and lowest age values, and standard deviation.</p>
</div>
<div id="1bcbfdf1-3fa6-47d6-b1dc-1eea2099ad52" class="cell code"
data-execution_count="53">
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">with</span>(data_training, <span class="fu">mean</span>(Age)),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">with</span>(data_training, <span class="fu">median</span>(Age)),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">with</span>(data_training, <span class="fu">max</span>(Age)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fu">with</span>(data_training, <span class="fu">min</span>(Age)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">standard_deviation =</span> <span class="fu">with</span>(data_training, <span class="fu">sd</span>(Age))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>summary</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 1 × 5</caption>
<thead>
	<tr><th scope=col>mean</th><th scope=col>median</th><th scope=col>max</th><th scope=col>min</th><th scope=col>standard_deviation</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>20.74627</td><td>19</td><td>50</td><td>8</td><td>6.29439</td></tr>
</tbody>
</table>

</div>
</div>
<div id="ca84aa7d-741d-4fcc-b07d-e71c569bf5b9" class="cell markdown">
<p>The training data shows that the minimum age is 8 years and the
maximum age is 50 years. The average age is 20.7 years, with a median
age of 19.</p>
<p>Before I build a model, I create a <strong>scatterplot</strong> with
<code>ggplot</code> to examine if there appears to be an association
between the <code>Age</code> and <code>played_hours</code>
variables.</p>
</div>
<div id="8181186e-c285-4146-aed0-2b4675ba36b4" class="cell markdown">
<h4 id="figure-1-total-playtime-vs-age"><strong>Figure 1. Total Playtime
vs. Age</strong></h4>
</div>
<div id="9f70ee8c-fb73-45c1-a16b-08be708a1f1f" class="cell code"
data-execution_count="54">
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">8</span>, <span class="at">repr.plot.height =</span> <span class="dv">8</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>age_playtime <span class="ot">&lt;-</span> data_training <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> Age)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">&quot;Total Playtime (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ylab</span>(<span class="st">&quot;Age (years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>age_playtime</span></code></pre></div>
<div class="output display_data">
<p><embed
src="vertopal_3ae17e88e5494ad3b4ad4e488087575c/6800407c81ac2ad0257ca7ccc4357f386ce2be58.pdf"
width="480" height="480" /></p>
</div>
</div>
<div id="d2eaea34-7c16-4b24-82aa-03fb44e8dc3f" class="cell markdown">
<p>This figure indicates that the training dataset primarily consists of
young players (&lt;25 years old) with minimal or no playing time. All
players that play for more than 25 hours are under 25 years old.</p>
<p>Figure 1 shows that the connection between 'Age' and 'played_hours'
is not very evident, although it may be flat or weakly linear. There
appear to be many outliers, with the bulk of participants having played
0 hours.</p>
<p>I would want to look at the link between Age and played_hours.
Because both variables are numerical and there is a hint of a linear
relationship, I will attempt a linear regression. Because I want to know
the features of players that provide a substantial quantity of data, I
will build a model that predicts Age based on played_hours. If my model
is correct (i.e., if the <strong>RMSE</strong> and
<strong>RMSPE</strong> are low enough), I will infer that a player's age
can help me estimate their <em>played hours</em>.</p>
<p>In this step, I will:</p>
<ul>
<li>create a linear regression model specification, named lm_spec</li>
<li>create a recipe for lm_spec, named data_recipe</li>
<li>fit the model specification and recipe in a workflow, named
data_fit</li>
</ul>
</div>
<div id="f0caead6-e067-4788-9df4-512c340fdaca" class="cell code"
data-execution_count="62">
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Age <span class="sc">~</span> played_hours, <span class="at">data =</span> data_training)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>data_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">add_recipe</span>(data_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">fit</span>(<span class="at">data =</span> data_training)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>data_fit</span></code></pre></div>
<div class="output display_data">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────

Call:
stats::lm(formula = ..y ~ ., data = data)

Coefficients:
 (Intercept)  played_hours  
    20.84164      -0.01682  
</code></pre>
</div>
</div>
<div id="4c48f114-4d9f-4dc4-94e5-72da24ee85a5" class="cell markdown">
<p>The equation of the line shows that for played_hours = 0, the
anticipated age is 20.84 (y-intercept). The slope is about zero. Because
most gamers play for zero hours, the intercept is near to the average
player age.</p>
<p>Next, I'll compute the <strong>RMSE</strong> and
<strong>RMSPE</strong> with <strong>data_training</strong> to determine
the goodness of fit for <code>data_fit</code>. This will tell me how
well the model predicts the training data used to fit it.</p>
</div>
<div id="f073a7c6-9ef4-4134-832a-84b248fbcdae" class="cell code"
data-execution_count="88">
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rmse_training <span class="ot">&lt;-</span> data_training <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(data_fit, <span class="at">new_data =</span> data_training)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmse</span>(<span class="at">truth =</span> Age, <span class="at">estimate =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(.estimate)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>rmspe_training <span class="ot">&lt;-</span> data_training <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(data_fit, <span class="at">new_data =</span> data_training)) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage_error =</span> ((Age <span class="sc">-</span> .pred) <span class="sc">/</span> Age)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rmspe =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(percentage_error, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rmspe)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmse_training)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmspe_training)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[1] 6.250865
[1] 0.2830374
</code></pre>
</div>
</div>
<div id="688559ae-9992-4513-9501-34b2e4bb7dc4" class="cell markdown">
<p>The <strong>RMSE</strong> and <strong>RMSPE</strong> with
<strong>training_data</strong> tells me that the training data points on
the scatterplot were off by ~6.25 years from the line of best fit and my
model has ~28.3% average percentage error.</p>
<p>Given that the sample largely comprises of players &lt; 25 years, a
6-year discrepancy in anticipated age is significant. Using
<code>played_hours</code> as a predictor produces an inaccurate
forecast.</p>
</div>
<div id="d81e0de2-a97e-4fc6-b2cd-6449fed512d4" class="cell markdown">
<p>The outliers (points of startlingly long play periods and points of
unusually advanced age) may contribute to this. I identify them by
arranging the data frame in <strong>descending order</strong> for each
variable using the <code>arrange</code> function.</p>
</div>
<div id="f47c0709-feca-45cf-b6f7-1efd2ba89a5a" class="cell markdown">
<h4 id="table-3-all-players-in-descending-order-of-age"><strong>Table 3.
All Players, in descending order of <code>age</code></strong></h4>
</div>
<div id="88e17072-f41b-4e79-b473-21820ede21ea" class="cell code"
data-execution_count="64">
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>age_desc <span class="ot">&lt;-</span> <span class="fu">arrange</span>(data, <span class="fu">desc</span>(Age))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(age_desc)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>hashedEmail</th><th scope=col>experience</th><th scope=col>subscribe</th><th scope=col>played_hours</th><th scope=col>name</th><th scope=col>gender</th><th scope=col>Age</th><th scope=col>number_of_sessions</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>7b17513f11968feaf6b02977885c436dc2a4549489ca25ef03022f9fbae19d81</td><td>Regular </td><td>FALSE</td><td> 0.0</td><td>Balthazar</td><td>Male  </td><td>50</td><td> 1</td></tr>
	<tr><th scope=row>2</th><td>c57fa94e436cf49a929d0168e47d26fec3d900b321775e280ef136979c01d5a4</td><td>Regular </td><td> TRUE</td><td>18.5</td><td>Dante    </td><td>Male  </td><td>49</td><td>16</td></tr>
	<tr><th scope=row>3</th><td>4c0662a559f9d83b4d84ce3d86e6577c9f7a426c80465c6174321afd96664da5</td><td>Veteran </td><td>FALSE</td><td> 0.0</td><td>Selena   </td><td>Male  </td><td>46</td><td>NA</td></tr>
	<tr><th scope=row>4</th><td>6fa105fac7f4f37350f21830db78cde153d8edda41d6f4f2d48c9785d605c5e5</td><td>Amateur </td><td>FALSE</td><td> 0.1</td><td>Yosef    </td><td>Male  </td><td>45</td><td> 1</td></tr>
	<tr><th scope=row>5</th><td>ba24bebe588a34ac546f8559850c65bc90cd9d51b821581bd6e25cff437a1081</td><td>Veteran </td><td> TRUE</td><td> 0.1</td><td>Gabriela </td><td>Female</td><td>44</td><td> 1</td></tr>
	<tr><th scope=row>6</th><td>5e5c25a773be7a62638a163d773534e575a5ad5782104723e53cb676a30fa60b</td><td>Beginner</td><td>FALSE</td><td> 0.0</td><td>Jude     </td><td>Female</td><td>42</td><td>NA</td></tr>
</tbody>
</table>

</div>
</div>
<div id="0dbdeac1-6143-42c8-8d42-ca2bae4887d8" class="cell markdown">
<p>(Only the head is displayed for the sake of readability.)</p>
</div>
<div id="7f2d415a-c7b8-49a0-b549-6157ec6afe71" class="cell markdown">
<h4
id="table-4-all-players-in-descending-order-of-played_hours"><strong>Table
4. All Players, in descending order of
<code>played_hours</code></strong></h4>
</div>
<div id="f70f1c23-e228-4adb-8709-f5d1aa0d96ac" class="cell code"
data-execution_count="65">
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>playtime_desc <span class="ot">&lt;-</span> <span class="fu">arrange</span>(data, <span class="fu">desc</span>(played_hours))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(playtime_desc)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>hashedEmail</th><th scope=col>experience</th><th scope=col>subscribe</th><th scope=col>played_hours</th><th scope=col>name</th><th scope=col>gender</th><th scope=col>Age</th><th scope=col>number_of_sessions</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>bfce39c89d6549f2bb94d8064d3ce69dc3d7e72b38f431d8aa0c4bf95ccee6bf</td><td>Regular</td><td>TRUE</td><td>223.1</td><td>Hiroshi</td><td>Male      </td><td>17</td><td>219</td></tr>
	<tr><th scope=row>2</th><td>b622593d2ef8b337dc554acb307d04a88114f2bf453b18fb5d2c80052aeb2319</td><td>Regular</td><td>TRUE</td><td>218.1</td><td>Akio   </td><td>Non-binary</td><td>20</td><td> 95</td></tr>
	<tr><th scope=row>3</th><td>ad6390295640af1ed0e45ffc58a53b2d9074b0eea694b16210addd44d7c81f83</td><td>Regular</td><td>TRUE</td><td>178.2</td><td>Piper  </td><td>Female    </td><td>19</td><td>147</td></tr>
	<tr><th scope=row>4</th><td>f8f5477f5a2e53616ae37421b1c660b971192bd8ff77e3398304c7ae42581fdc</td><td>Amateur</td><td>TRUE</td><td>150.0</td><td>Delara </td><td>Female    </td><td>16</td><td>159</td></tr>
	<tr><th scope=row>5</th><td>fd6563a4e0f6f4273580e5fedbd8dda64990447aea5a33cbb5e894a3867ca44d</td><td>Amateur</td><td>TRUE</td><td> 56.1</td><td>Dana   </td><td>Male      </td><td>23</td><td>310</td></tr>
	<tr><th scope=row>6</th><td>36d9cbb4c6bc0c1a6911436d2da0d09ec625e43e6552f575d4acc9cf487c4686</td><td>Amateur</td><td>TRUE</td><td> 53.9</td><td>Alex   </td><td>Male      </td><td>17</td><td>130</td></tr>
</tbody>
</table>

</div>
</div>
<div id="a182a719-7267-4633-937c-de22b56c9a8a" class="cell markdown">
<p>(Only the head is displayed for the sake of readability.)</p>
<p>I can see that players <strong>Balthazar, Dante, Selena, Yosef,
Gabriela, Jude, Hiroshi, Akio, Piper, and Delara</strong> have either:
(1) playtimes that are orders of magnitude higher than most of the
players, or (2) a significantly advanced age when compared to most other
players.</p>
<p>I believe outliers of type (1) may be research team members testing
the server. I only want to incorporate participant data. I believe
outliers of type (2) are produced by gamers submitting an incorrect age
or just having a lot more spare time than ordinary persons at their
ages. These outliers might be influencing our model's accuracy.</p>
<p>I use <code>filter</code> function to remove types (1) and (2) from
the data frame.</p>
</div>
<div id="3a49f813-23ab-4607-9362-29f82fada005" class="cell markdown">
<h4
id="table-5-dataframe-of-all-player-data-with-outliers-removed"><strong>Table
5. Dataframe of all player data, with outliers removed</strong></h4>
</div>
<div id="4210e69e-7060-464e-b60c-54528db6003d" class="cell code"
data-execution_count="66">
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Balthazar&#39;</span>, <span class="st">&#39;Dante&#39;</span>, <span class="st">&#39;Selena&#39;</span>, <span class="st">&#39;Yosef&#39;</span>, <span class="st">&#39;Gabriela&#39;</span>, <span class="st">&#39;Jude&#39;</span>, <span class="st">&#39;Hiroshi&#39;</span>, <span class="st">&#39;Akio&#39;</span>, <span class="st">&#39;Piper&#39;</span>, <span class="st">&#39;Delara&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>revised_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, <span class="sc">!</span>name <span class="sc">%in%</span> outliers)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(revised_data)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>hashedEmail</th><th scope=col>experience</th><th scope=col>subscribe</th><th scope=col>played_hours</th><th scope=col>name</th><th scope=col>gender</th><th scope=col>Age</th><th scope=col>number_of_sessions</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>0088b5e134c3f0498a18c7ea6b8d77b4b0ff1636fc93355ccc95b45423367832</td><td>Regular </td><td> TRUE</td><td>1.5</td><td>Isaac  </td><td>Male</td><td>20</td><td> 2</td></tr>
	<tr><th scope=row>2</th><td>055d1a2002f6308a95b03b8d17af28f43e9f91ca8b1e1fc439bf4d08b22e7c0f</td><td>Veteran </td><td> TRUE</td><td>0.0</td><td>Frankie</td><td>Male</td><td>17</td><td>NA</td></tr>
	<tr><th scope=row>3</th><td>060aca80f8cfbf1c91553a72f4d5ec8034764b05ab59fe8e1cf0eee9a7b67967</td><td>Pro     </td><td>FALSE</td><td>0.4</td><td>Lyra   </td><td>Male</td><td>21</td><td> 1</td></tr>
	<tr><th scope=row>4</th><td>0ce7bfa910d47fc91f21a7b3acd8f33bde6db57912ce0290fa0437ce0b97f387</td><td>Beginner</td><td> TRUE</td><td>0.1</td><td>Osiris </td><td>Male</td><td>17</td><td> 1</td></tr>
	<tr><th scope=row>5</th><td>0d4d71be33e2bc7266ee4983002bd930f69d304288a8663529c875f40f1750f3</td><td>Regular </td><td> TRUE</td><td>5.6</td><td>Winslow</td><td>Male</td><td>17</td><td>13</td></tr>
	<tr><th scope=row>6</th><td>0d70dd9cac34d646c810b1846fe6a85b9e288a76f5dcab9c1ff1a0e7ca200b3a</td><td>Pro     </td><td> TRUE</td><td>1.0</td><td>Knox   </td><td>Male</td><td>17</td><td> 2</td></tr>
</tbody>
</table>

</div>
</div>
<div id="c6591843-21aa-4727-9a0b-8514619cb836" class="cell markdown">
<p>Using this revised data frame, I'll now repeat the whole procedure
(except for constructing the recipe, which is identical) and compute the
<strong>RMSE</strong> and <strong>RMSPE</strong>.</p>
</div>
<div id="36991ea9-a57e-46d1-82f6-e30f6d2c689d" class="cell code"
data-execution_count="67">
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>revised_data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(revised_data, <span class="at">prop =</span> <span class="fl">0.7</span>, <span class="at">strata =</span> Age)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>revised_data_training <span class="ot">&lt;-</span> <span class="fu">training</span>(revised_data_split)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>revised_data_testing <span class="ot">&lt;-</span> <span class="fu">testing</span>(revised_data_split)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>revised_data_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Age <span class="sc">~</span> played_hours, <span class="at">data =</span> revised_data_training)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>revised_data_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">add_recipe</span>(revised_data_recipe) <span class="sc">|&gt;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">add_model</span>(lm_spec) <span class="sc">|&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">fit</span>(<span class="at">data =</span> revised_data_training)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>revised_data_fit</span></code></pre></div>
<div class="output display_data">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────

Call:
stats::lm(formula = ..y ~ ., data = data)

Coefficients:
 (Intercept)  played_hours  
    19.95875      -0.08645  
</code></pre>
</div>
</div>
<div id="3edf6828-f336-4bd1-b990-423f4357ef21" class="cell code"
data-execution_count="86">
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>revised_rmse_training <span class="ot">&lt;-</span> revised_data_training <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(revised_data_fit, <span class="at">new_data =</span> revised_data_training)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmse</span>(<span class="at">truth =</span> Age, <span class="at">estimate =</span> .pred) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(.estimate)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>revised_rmspe_training <span class="ot">&lt;-</span> revised_data_training <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(revised_data_fit, <span class="at">new_data =</span> revised_data_training)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage_error =</span> ((Age <span class="sc">-</span> .pred) <span class="sc">/</span> Age)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rmspe =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(percentage_error, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rmspe)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(revised_rmse_training)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(revised_rmspe_training)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[1] 3.946607
[1] 0.1887416
</code></pre>
</div>
</div>
<div id="4b6c5bff-3a30-4d56-9c80-801a21656a1a" class="cell markdown">
<p>The revised <strong>RMSE</strong> and <strong>RMSPE</strong> values
are both lower than the previous values computed with outliers. The
<strong>RMSE</strong> of 3.94 is far more accurate than the previous
estimate of ~6.25 years. The model has a reasonable
<strong>RMSPE</strong> value of 18.87%, which is generally
acceptable.</p>
</div>
<div id="6141f157-0446-485c-b333-048292e7a583" class="cell markdown">
<h3 id="visualization-of-linear-regression">Visualization of Linear
Regression</h3>
<p>Finally, I visualize the linear model I developed, notably the one
without outliers.</p>
</div>
<div id="aa42e50a-7824-4348-98e2-442d7e41a252" class="cell markdown">
<h4 id="figure-2-total-playtime-vs-player-age"><strong>Figure 2. Total
Playtime vs Player Age</strong></h4>
</div>
<div id="379a1e4e-2255-4656-967d-a54c03bd353b" class="cell code"
data-execution_count="68">
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">6</span>, <span class="at">repr.plot.height =</span> <span class="dv">6</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># With Outliers</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lm_preds_1 <span class="ot">&lt;-</span> data_fit <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(data_training) <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(data_training)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>lm_predictions_1 <span class="ot">&lt;-</span> lm_preds_1 <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>	<span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> Age)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_line</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        	<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> .pred),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        	<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">xlab</span>(<span class="st">&quot;Total Playtime (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;Age (years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">ggtitle</span>(<span class="st">&quot;Figure 2. Total Playtime vs Player Age </span><span class="sc">\n</span><span class="st"> (With Outliers)&quot;</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Without Outliers</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>lm_preds_2 <span class="ot">&lt;-</span> revised_data_fit <span class="sc">|&gt;</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(revised_data_training) <span class="sc">|&gt;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(revised_data_training)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>lm_predictions_2 <span class="ot">&lt;-</span> lm_preds_2 <span class="sc">|&gt;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>	<span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> Age)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_line</span>(</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        	<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> .pred),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        	<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">xlab</span>(<span class="st">&quot;Total Playtime (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;Age (years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">ggtitle</span>(<span class="st">&quot;Figure 3. Total Playtime vs Player Age </span><span class="sc">\n</span><span class="st"> (Without Outliers)&quot;</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>lm_predictions_1</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>lm_predictions_2</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).”
</code></pre>
</div>
<div class="output display_data">
<p><embed
src="vertopal_3ae17e88e5494ad3b4ad4e488087575c/40fd6ed13d43bddcfee3f7c3b6f04d9af9b3d849.pdf"
width="360" height="360" /></p>
</div>
<div class="output display_data">
<p><embed
src="vertopal_3ae17e88e5494ad3b4ad4e488087575c/1c39c98709db88b8c8c410358e4311e4d6bb27c8.pdf"
width="360" height="360" /></p>
</div>
</div>
<div id="c186e6e4-5570-40f5-89e7-5c875ce986b6" class="cell markdown">
<p>The model with outliers eliminated outperformed the model with
outliers. However, other variables may be stronger predictors.</p>
<p>It's possible that <code>Age</code> and <code>played_hours</code>
have a stronger relationship, but it isn't linear. In my next analysis,
knn-regression, I will investigate this option.</p>
</div>
<div id="21cdeecc-57ba-4fdf-a638-a60875497840" class="cell markdown">
<h2 id="data-analysis-2---knn-regression">Data Analysis 2 - KNN
Regression</h2>
<p>Instead of using linear regression, I may create a knn-regression
model. Re-examining figure 1, the connection does not appear to be very
linear; the data's characteristics may suggest that a non-linear model
is a better fit.</p>
<p>We can use knn regression to predict <code>Age</code> based on
<code>total_played_hours</code>.</p>
<p>To begin, I'll need to do 5-fold cross validation on the training
dataset to get the best k. I will use the data without the outliers.</p>
</div>
<div id="549451f4-4260-4721-a599-3ac33f40aa67" class="cell code"
data-execution_count="73">
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data_model_knn <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="fu">tune</span>(), <span class="at">weight_func =</span> <span class="st">&quot;rectangular&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>recipe_knn <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Age <span class="sc">~</span> played_hours, <span class="at">data =</span> revised_data_training) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data, <span class="at">v =</span> <span class="dv">5</span>, <span class="at">strata =</span> Age)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>workflow_knn <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(data_model_knn) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_knn)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">neighbors =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>tuning_results <span class="ot">&lt;-</span> workflow_knn <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> k_values</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tuning_results)</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A tibble: 6 × 7</caption>
<thead>
	<tr><th scope=col>neighbors</th><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>mean</th><th scope=col>n</th><th scope=col>std_err</th><th scope=col>.config</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>rmse</td><td>standard</td><td>7.51980875</td><td>5</td><td>0.53567652</td><td>Preprocessor1_Model01</td></tr>
	<tr><td>1</td><td>rsq </td><td>standard</td><td>0.05139263</td><td>5</td><td>0.03608594</td><td>Preprocessor1_Model01</td></tr>
	<tr><td>2</td><td>rmse</td><td>standard</td><td>6.82479480</td><td>5</td><td>0.41646930</td><td>Preprocessor1_Model02</td></tr>
	<tr><td>2</td><td>rsq </td><td>standard</td><td>0.02672265</td><td>5</td><td>0.01436328</td><td>Preprocessor1_Model02</td></tr>
	<tr><td>3</td><td>rmse</td><td>standard</td><td>6.73006674</td><td>5</td><td>0.41926061</td><td>Preprocessor1_Model03</td></tr>
	<tr><td>3</td><td>rsq </td><td>standard</td><td>0.02913138</td><td>5</td><td>0.01117737</td><td>Preprocessor1_Model03</td></tr>
</tbody>
</table>

</div>
</div>
<div id="4bb4eb3a-b229-419c-be66-fa87d41cfa1b" class="cell markdown">
<p>The optimal k will have the lowest <strong>RMSE</strong> value. Thus,
I look for the k value that results in the <strong>minimum
RMSE</strong>.</p>
</div>
<div id="1ed5af74-5d64-4aa5-854f-0f9ed8c87573" class="cell code"
data-execution_count="75">
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>best_result <span class="ot">&lt;-</span> data_results <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rmse&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>k_min <span class="ot">&lt;-</span> best_result <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(neighbors)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>k_min</span></code></pre></div>
<div class="output display_data">
10
</div>
</div>
<div id="9ca873fe-16b5-4426-bfaa-eadb5454415c" class="cell markdown">
<p>Now, I can train my final model using this k value.</p>
</div>
<div id="aac62fb6-59bd-4352-b4b7-d8706d99f438" class="cell code"
data-execution_count="95">
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>final_knn_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="dv">10</span>, <span class="at">weight_func =</span> <span class="st">&quot;rectangular&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>final_knn_model <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(final_knn_spec) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(revised_data_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> revised_data_training)</span></code></pre></div>
</div>
<div id="4eaae32b-ff21-419f-b585-19ddef1d8237" class="cell markdown">
<p>Next, I test the model's efficacy using the metrics function.</p>
</div>
<div id="d2de6d92-927b-4d4b-8f5b-b93e5f40f147" class="cell code"
data-execution_count="96">
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> data_best_fit <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">predict</span>(revised_data_training) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">bind_cols</span>(revised_data_training) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">metrics</span>(<span class="at">truth =</span> Age, <span class="at">estimate =</span> .pred)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>data_summary</span></code></pre></div>
<div class="output display_data">
<table class="dataframe">
<caption>A tibble: 3 × 3</caption>
<thead>
	<tr><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>.estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>rmse</td><td>standard</td><td>4.27513111</td></tr>
	<tr><td>rsq </td><td>standard</td><td>0.04586744</td></tr>
	<tr><td>mae </td><td>standard</td><td>2.79920635</td></tr>
</tbody>
</table>

</div>
</div>
<div id="7a6efaea-6c18-43d4-8f51-fbb4151c90f8" class="cell markdown">
<p>The <strong>RMSE</strong> is approximately 4.27. This means the
average difference between a data point and my line of best fit is 4.27
years.</p>
<p>Out of my expectation, this model's performance on predicating
<code>Age</code> based on <code>played_hours</code> is worse than the
linear model.</p>
</div>
<div id="f7c90c7d-3e93-495d-9d22-059c89675c1b" class="cell markdown">
<h3 id="visualization-of-knn-regression">Visualization of KNN
Regression</h3>
<p>Finally, I visualize the model I have created.</p>
</div>
<div id="86f686e3-0f75-4777-96dc-bb1a327fd5f0" class="cell markdown">
<h4
id="figure-4-total-playtime-vs-player-age-knn-regression-without-outliers"><strong>Figure
4. Total Playtime vs Player Age (KNN Regression without
outliers)</strong></h4>
</div>
<div id="b528c845-e933-41a1-9ae9-5def9409418d" class="cell code"
data-execution_count="97">
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">6</span>, <span class="at">repr.plot.height =</span> <span class="dv">6</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>ref_data_preds <span class="ot">&lt;-</span> data_best_fit <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(revised_data_training) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(revised_data_training)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>knn_predictions <span class="ot">&lt;-</span> ref_data_preds <span class="sc">|&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>	<span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> Age)) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">geom_line</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        	<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> played_hours, <span class="at">y =</span> .pred),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        	<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">xlab</span>(<span class="st">&quot;Total Playtime (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">&quot;Age (years)&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    	<span class="fu">ggtitle</span>(<span class="st">&quot;Figure 4. Total Playtime vs Player Age </span><span class="sc">\n</span><span class="st"> (KNN Regression without outliers)&quot;</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>knn_predictions</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).”
</code></pre>
</div>
<div class="output display_data">
<p><embed
src="vertopal_3ae17e88e5494ad3b4ad4e488087575c/18560a2691c4b52ca52c2ce25ccfc491b783f92c.pdf"
width="360" height="360" /></p>
</div>
</div>
<div id="9b8fcec2-a341-419f-85c6-a42c4c1435df" class="cell markdown">
<p>I notice significant overfitting in this part of the model,
particularly for lesser amounts of played hours. This shows that my k
value is too low. However, a greater k leads to a higher
<strong>RMSE</strong>, as calculated above. This paradox is most likely
caused by the vast number of points at or near zero, as well as the
relative scarcity of data points across a bigger number of played
hours!</p>
</div>
<div id="a4d0f76f-c223-4473-b437-89516b6e79ab" class="cell markdown">
<h1 id="discussion">Discussion</h1>
</div>
<div id="ed9107a1-c826-4fb5-bead-1ad224c7cf3a" class="cell markdown">
<h2 id="summary">Summary</h2>
<p>In my exploratory data analysis, I plotted <code>Age</code> versus
<code>Played_hours</code> (Figure 1). Based on my exploratory study, I
predicted a linear relationship between the player's age and the overall
number of hours played. I built a linear regression model in which the
predictor variable was the total number of hours played (played_hours)
and the predicted variable was the player's age (Age).</p>
<p>To evaluate the model's performance, I used the training model to
estimate age from test data and computed the RMSE. With outliers, the
model had a RMSE of 6.25, but without them, it was 3.94. My findings
indicate that there is a weak to moderately negative linear association
between age and total played hours. <strong>Figure 1 shows that gamers
under the age of 25 contribute the greatest playtime.</strong></p>
<p>When a linear model did not produce a very good RMSE, I examined the
exploratory plot and recognized the relationship might not be linear. I
subsequently built a knn regression model, which had a similarly
morderate RMSE of 4.27.</p>
<p><strong>I conclude that both model are moderately effective,
especially when eliminating the outliers</strong>.</p>
</div>
<div id="7bb57459-6183-4d68-8de7-493fd3d91401" class="cell markdown">
<h2 id="expectations-and-limitations">Expectations and Limitations</h2>
</div>
<div id="b29f0f54-3b04-4b3f-be56-21b8b422db15" class="cell markdown">
<p>My expectations were somewhat met by the outcomes. I didn't
anticipate a very well-fitting model or a low RMSPE because the linear
relationship looked weak and flat in the exploratory analysis.</p>
<p>Early on in the project, I was worried about the size of the dataset,
especially since a significant percentage of users (85/196) provided
zero hours of gameplay. I could make better predictions with a dataset
that was more representative of a variety of played hours! These 0 hour
points are probably what drove the association I saw, producing model
slopes that are almost flat and erasing any other patterns I could have
noticed.</p>
</div>
<div id="3c658aa7-4164-4630-8658-240c8bdf61da" class="cell markdown">
<h2 id="potential-impact">Potential Impact</h2>
<p>Targeted marketing and recruitment efforts can benefit from knowing
the demographic information of the people who provide the most
playtime.</p>
<p>In this instance, the study team can concentrate their attention on
younger gamers (those under 25), as I think they may contribute the
greatest playtime. For instance, the researchers might promote their
study in places that young adults visit, such as social media, relevant
subreddits, colleges, universities, and high schools.</p>
<p>Additionally, the researchers might concentrate their efforts on
improving younger players' interest. For instance, social or competitive
aspects may be very enticing to this group.</p>
</div>
<div id="d4b56e80-3f89-4cd2-bc11-b924aa3cbd76" class="cell markdown">
<h2 id="future-question">Future Question</h2>
<p>My research leads me to a number of areas for further study. My
question is "Can I use played_hours to more accurately predict other
demographic characteristics of players?"</p>
<p>Investigating subscription status and its connection to played hours
seems interesting. Based on my own projects' exploratory visualizations,
I discovered that nearly every player with a high level of played_hours
receives Plaicraft email updates. Subscription status might be used to
forecast the amount of hours played in future research.</p>
<p>Additionally, I anticipate that investigating experience level and
its connection to played_hours may be intriguing. According to my own
exploratory data studies, frequent and amateur players have more played
hours than players with other expertise levels.</p>
</div>
</body>
</html>
